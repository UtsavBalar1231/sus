# Astro Documentation Scraper Configuration
# Modern static site framework documentation (~100+ pages)

# Project metadata
name: astro-docs
description: Astro web framework documentation scraper

# Site configuration
site:
  # Starting URL for the crawl
  start_urls:
    - https://docs.astro.build/en/getting-started/

  # Allowed domains
  allowed_domains:
    - docs.astro.build

# Crawling rules and behavior
crawling:
  # Only follow links in the English documentation
  include_patterns:
    - pattern: "/en/"
      type: prefix

  # Exclude other language versions and assets
  exclude_patterns:
    - pattern: "/es/"
      type: prefix
    - pattern: "/fr/"
      type: prefix
    - pattern: "/de/"
      type: prefix
    - pattern: "/ja/"
      type: prefix
    - pattern: "/zh-cn/"
      type: prefix
    - pattern: "/zh-tw/"
      type: prefix
    - pattern: "/ko/"
      type: prefix
    - pattern: "/pt-br/"
      type: prefix
    - pattern: "/ru/"
      type: prefix
    - pattern: "/it/"
      type: prefix
    - pattern: "/_astro/"
      type: prefix
    - pattern: "*.pdf"
      type: glob
    - pattern: "*.zip"
      type: glob

  # No depth limit (crawl entire doc tree)
  depth_limit: null

  # No page limit (scrape all documentation)
  max_pages: null

  # Rate limiting (be respectful)
  delay_between_requests: 0.5

  # Concurrency settings
  global_concurrent_requests: 8
  per_domain_concurrent_requests: 2

  # Retry settings
  max_retries: 3
  retry_backoff: 2.0

  # Respect robots.txt
  respect_robots_txt: true

  # Default link selector
  link_selectors:
    - a[href]

# Output configuration
output:
  # Base output directory
  base_dir: output

  # Site-specific subdirectory
  site_dir: astro

  # Directory structure
  structure:
    docs_dir: docs
    assets_dir: assets

  # Path mapping: URL to file path conversion
  path_mapping:
    mode: auto
    strip_prefix: /en
    index_file: index.md

  # Markdown generation settings
  markdown:
    add_frontmatter: true
    frontmatter_fields:
      - title
      - url
      - scraped_at

    # Content filtering strategy for Astro/Starlight docs:
    # 1. Whitelist: Extract only <main> tag (removes header, nav, footer, sidebar)
    # 2. Blacklist: Remove .not-content elements (decorative logos, facepiles)
    # This produces clean markdown with only documentation content
    content_filtering:
      enabled: true
      # Whitelist: Keep only the main content area
      keep_selectors:
        - main        # Main documentation content (Astro docs use <main> tag)
      # Blacklist: Remove decorative elements within main
      remove_selectors:
        - .not-content  # Astro's semantic marker for decorative elements

# Asset handling
assets:
  # Enable asset downloads
  download: true

  # Asset types to download
  types:
    - image
    - css
    - javascript

  # Rewrite asset paths to relative paths
  rewrite_paths: true
